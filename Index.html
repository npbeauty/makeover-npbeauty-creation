<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NP Beauty Creation — Home</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Your main stylesheet (kept as reference) -->
  <link href="css/style.css" rel="stylesheet">

  <style>
    :root{--accent:#ff4da6;--muted:#6c757d;--bg:#fff7fb}
    *{box-sizing:border-box}
    body{font-family: Roboto, system-ui, -apple-system, "Segoe UI", Arial; margin:0; color:#222; background:#fff;}
    .hero{background:linear-gradient(135deg,#ff69b4 0%, #ffd700 100%); color:#fff; text-align:center; padding:80px 0;}
    .hero h1{font-family:'Playfair Display',serif; font-size:2.4rem; margin-bottom:.4rem}
    .section{padding:48px 0}
    .service-card{border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.06); padding:18px; transition:transform .25s; background:#fff}
    .service-card:hover{transform:translateY(-6px)}
    .price{font-weight:700; color:var(--accent)}
    #selectedServices{min-height:2rem; padding:.6rem; border:1px dashed #eee; border-radius:6px; background:#fff}
    footer{background:#222; color:#fff; padding:28px 0; text-align:center; margin-top:36px}
    .small-muted{color:var(--muted); font-size:.9rem}
    .badge-min{background:#ff4da6;color:#fff;padding:.35rem .6rem;border-radius:999px;font-weight:600}
    @media (min-width:992px){
      .services-grid .service-card{height:100%}
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="index.html">NP Beauty Creation</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
          <li class="nav-item"><a class="nav-link" href="services.html">Services</a></li>
          <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
          <li class="nav-item"><a class="nav-link" href="testimonials.html">Testimonials</a></li>
          <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
          <li class="nav-item"><a class="nav-link" href="faq.html">FAQ</a></li>
          <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
          <li class="nav-item"><a class="nav-link" href="policies.html">Policies</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1>Welcome to NP Beauty Creation</h1>
      <p style="font-size:1.05rem; margin:0">Transform your look with our expert beauty services — book online in seconds</p>
      <a href="#booking" class="btn btn-light mt-3">Book Now</a>
    </div>
  </section>

  <!-- Services Section -->
  <section id="services" class="py-5 bg-light">
    <div class="container">
      <h2 class="mb-4">Our Services</h2>
      <div class="row g-3 services-grid">
        <!-- Haircut & Styling -->
        <div class="col-md-4"><div class="service-card"><h5>Haircut & Styling</h5><p class="small-muted">Professional haircut and styling</p><p class="price" data-price="500">Starting ₹500</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Hair Colour -->
        <div class="col-md-4"><div class="service-card"><h5>Hair Colour</h5><p class="small-muted">Full hair colouring</p><p class="price" data-price="1500">Starting ₹1500</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Bridal Makeup -->
        <div class="col-md-4"><div class="service-card"><h5>Bridal Makeup</h5><p class="small-muted">Complete bridal makeup package</p><p class="price" data-price="8000">Starting ₹8000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Facials & Skincare -->
        <div class="col-md-4"><div class="service-card"><h5>Facials & Skincare</h5><p class="small-muted">Glow & rejuvenation treatments</p><p class="price" data-price="1000">Starting ₹1000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Party Makeup -->
        <div class="col-md-4"><div class="service-card"><h5>Party Makeup</h5><p class="small-muted">Stylish makeup for events & occasions</p><p class="price" data-price="2000">Starting ₹2000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Manicure & Pedicure -->
        <div class="col-md-4"><div class="service-card"><h5>Manicure & Pedicure</h5><p class="small-muted">Hand & foot pampering treatment</p><p class="price" data-price="1000">Starting ₹1000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Waxing & Threading -->
        <div class="col-md-4"><div class="service-card"><h5>Waxing & Threading</h5><p class="small-muted">Full grooming & hair removal</p><p class="price" data-price="100">Starting ₹100</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Relaxing Massages -->
        <div class="col-md-4"><div class="service-card"><h5>Relaxing Massages</h5><p class="small-muted">Stress relief & relaxation therapy</p><p class="price" data-price="4000">Starting ₹4000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Deep Conditioning Treatments -->
        <div class="col-md-4"><div class="service-card"><h5>Deep Conditioning Treatments</h5><p class="small-muted">Hair repair & nourishment</p><p class="price" data-price="3000">Starting ₹3000</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
        <!-- Nail Art & Extensions -->
        <div class="col-md-4"><div class="service-card"><h5>Nail Art & Extensions</h5><p class="small-muted">Trendy designs & nail enhancement</p><p class="price" data-price="500">Starting ₹500</p><button class="btn btn-outline-primary btn-sm select-service mt-2">Select</button></div></div>
      </div>
    </div>
  </section>

  <!-- Booking Section -->
  <section id="booking" class="section">
    <div class="container">
      <h2 class="mb-4">Book an Appointment</h2>

      <div class="row">
        <div class="col-lg-7">
          <form id="bookingForm" class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Full name *</label>
              <input id="name" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone *</label>
              <input id="phone" class="form-control" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Email</label>
              <input id="email" type="email" class="form-control">
            </div>
            <div class="col-md-6">
              <label class="form-label">Select date *</label>
              <input id="date" type="date" class="form-control" required>
            </div>

            <div class="col-12">
              <label class="form-label">Selected services</label>
              <div id="selectedServices">No services selected</div>
            </div>

            <div class="col-md-4">
              <label class="form-label">Minimum booking</label>
              <input id="minAmount" class="form-control" readonly value="₹0">
            </div>
            <div class="col-md-4">
              <label class="form-label">Total (auto)</label>
              <input id="totalAmount" class="form-control" readonly value="₹0">
            </div>
            <div class="col-md-4 d-flex align-items-end">
              <div class="form-check">
                <input id="payFull" class="form-check-input" type="checkbox">
                <label class="form-check-label" for="payFull">Pay full now</label>
                <div class="small-muted">Or pay a deposit (25% of selected services)</div>
              </div>
            </div>

            <div class="col-12">
              <label class="form-label">Notes</label>
              <textarea id="notes" class="form-control" rows="2"></textarea>
            </div>

            <div class="col-12">
              <p class="small-muted">Choose a payment method</p>
              <div id="paymentButtons" class="d-flex gap-2 align-items-start">
                <button id="razorpayBtn" type="button" class="btn btn-success">Pay with Razorpay</button>
                <div id="paypal-container"></div>
                <button id="stripeBtn" type="button" class="btn btn-primary">Pay with Stripe</button>
              </div>
              <div class="mt-2 small-muted">Payments processed securely. For full verification implement the server endpoints described below.</div>
            </div>
          </form>
        </div>

        <div class="col-lg-5">
          <div class="card p-3">
            <h5>Order summary</h5>
            <div id="summaryList" class="mb-3 small-muted">No services selected</div>

            <!-- Deposit Line (visible explanation of 25%) -->
            <div class="small-muted mb-1">
                Deposit (25%): <span id="depositAmount">₹0</span>
            </div>

            <div><strong>Amount to pay: </strong><span id="summaryAmount">₹0</span></div>

            <!-- Updated Badge -->
            <div class="mt-3">
                <span class="badge-min">Minimum 25% required</span>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

<!-- Footer -->
<footer class="footer bg-dark text-white py-3 text-center">
  <div class="container">
    <p>&copy; 2023 NP Beauty Creation. All rights reserved.</p>
    <p>Follow us: @npbeautycreation — Email: info8npbeautycreation@gmail.com<p/>
    <p>
        <li class="nav-item"><a class="nav-link active" href="policies.html">Privacy & Terms</a></li>
    </p>
  </div>
</footer>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <!-- PayPal SDK loaded dynamically in JS (so we can insert client-id from CONFIG) -->

<script>
/*
  Full front-end script:
  - Service selection
  - 25% deposit logic (display + calculation)
  - Pay full checkbox
  - Razorpay / PayPal (server-side create) / Stripe integration
  IMPORTANT: Replace CONFIG keys with your real keys.
  Ensure server endpoints exist:
    POST /create-razorpay-order  { amount, currency, booking } -> returns order
    POST /verify-razorpay-payment { razor, booking }
    POST /create-paypal-order { amount, booking } -> returns { orderId }
    POST /capture-paypal-payment { orderId } -> returns capture result
    POST /create-stripe-session { amount, booking } -> returns { id: sessionId }
*/

const CONFIG = {
  MIN_DEPOSIT_PERCENT: 0.25,
  CURRENCY: 'INR',
  RAZORPAY_KEY_ID: 'rzp_test_YOUR_KEY',   // replace with your Razorpay key id (public)
  PAYPAL_CLIENT_ID: 'AWPFX7YbPXY--1m62ENVu6rR8-h9BvGEDi7aQB7EoWrAlS6vS5HompgVovWTty7tb1zdfBpabHs6FAlk', // replace with your PayPal client id
  STRIPE_PUBLIC_KEY: 'pk_live_51P31cn09e2v364nuJC8gcLGwb808rnW8CRTeC7cuoqOHDBfebn8l2W9WIRMpE1hoDFsTek0yEMIB5HZWvh8rjcxi00YKObQ1fX' // replace with your Stripe public key
};

document.addEventListener('DOMContentLoaded', () => {
  // elements
  const serviceBtns = document.querySelectorAll('.select-service');
  const selectedServicesEl = document.getElementById('selectedServices');
  const totalAmountInput = document.getElementById('totalAmount');
  const minAmountInput = document.getElementById('minAmount');
  const payFullCheckbox = document.getElementById('payFull');
  const summaryList = document.getElementById('summaryList');
  const summaryAmount = document.getElementById('summaryAmount');
  const depositAmountEl = document.getElementById('depositAmount');

  const razorpayBtn = document.getElementById('razorpayBtn');
  const stripeBtn = document.getElementById('stripeBtn');

  let selectedServices = [];

  minAmountInput.value = `₹0`;
  updateUI();

  // Attach handlers for service selection
  serviceBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const card = btn.closest('.service-card');
      const name = card.querySelector('h5').textContent.trim();
      const price = Number(card.querySelector('.price').dataset.price);
      const idx = selectedServices.findIndex(s => s.name === name);
      if (idx === -1){
        selectedServices.push({name, price});
        btn.classList.remove('btn-outline-primary');
        btn.classList.add('btn-primary');
        btn.textContent = 'Selected';
      } else {
        selectedServices.splice(idx,1);
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-outline-primary');
        btn.textContent = 'Select';
      }
      updateUI();
    });
  });

  payFullCheckbox.addEventListener('change', updateUI);

  function calcSum(){
    return selectedServices.reduce((a,b)=>a+b.price,0);
  }

  function calcDeposit() {
    const sum = calcSum();
    return Math.ceil(sum * CONFIG.MIN_DEPOSIT_PERCENT);
  }

  function calcTotal(){
    const sum = calcSum();
    if (payFullCheckbox.checked) return sum;
    return calcDeposit();
  }

  function updateUI(){
    if(selectedServices.length === 0){
      selectedServicesEl.textContent = 'No services selected';
      summaryList.textContent = 'No services selected';
      depositAmountEl.textContent = `₹0`;
      minAmountInput.value = `₹0`;
      totalAmountInput.value = `₹0`;
      summaryAmount.textContent = `₹0`;
      return;
    } else {
      selectedServicesEl.innerHTML = selectedServices.map(s => `${s.name} — ₹${s.price}`).join('<br>');
      summaryList.innerHTML = selectedServices.map(s => `${s.name} — ₹${s.price}`).join('<br>');
    }

    const sum = calcSum();
    const deposit = calcDeposit();
    const total = calcTotal();

    // Update UI fields
    minAmountInput.value = `₹${deposit}`;
    totalAmountInput.value = `₹${total}`;
    depositAmountEl.textContent = `₹${deposit}`;
    summaryAmount.textContent = `₹${total}`;
  }

  // Collect form data
  function collectForm(){
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const date = document.getElementById('date').value;
    const notes = document.getElementById('notes').value.trim();
    if(!name || !phone || !date || selectedServices.length===0){
      alert('Please fill required fields: name, phone, date and select at least one service.');
      return null;
    }
    return {
      name, phone, email, date, notes,
      services: selectedServices,
      amount: calcTotal(),    // rupees (integer)
      payFull: payFullCheckbox.checked,
      currency: CONFIG.CURRENCY
    };
  }

  // Razorpay flow (uses server /create-razorpay-order)
  razorpayBtn.addEventListener('click', async (ev) => {
    ev.preventDefault();
    const data = collectForm();
    if(!data) return;

    try {
      // Ask server to create an order
      const resp = await axios.post('http://localhost:3000/create-razorpay-order', {
        amount: data.amount,
        currency: CONFIG.CURRENCY,
        booking: data
      });

      const order = resp.data.order || resp.data; // server returns { order }
      if(!order || !order.id){
        console.error('Invalid order from server', resp.data);
        alert('Failed to initialize Razorpay order');
        return;
      }

      const options = {
        key: CONFIG.RAZORPAY_KEY_ID,
        amount: order.amount, // Razorpay amount in paise (server returns paise)
        currency: order.currency || CONFIG.CURRENCY,
        name: 'NP Beauty Creation',
        description: `Booking for ${data.name}`,
        order_id: order.id,
        prefill: { name: data.name, contact: data.phone, email: data.email },
        handler: async function (razorResp) {
          try {
            // Verify payment on server
            const verify = await axios.post('http://localhost:3000/verify-razorpay-payment', {
              razor: razorResp,
              booking: data
            });
            if(verify.data && verify.data.success){
              window.location.href = '/success.html';
            } else {
              window.location.href = '/failure.html';
            }
          } catch (err) {
            console.error('Verify error', err);
            window.location.href = '/failure.html';
          }
        },
        modal: {
          ondismiss: function(){ /* user closed modal */ }
        }
      };

      const rzp = new Razorpay(options);
      rzp.open();
    } catch (err) {
      console.error(err);
      alert('Failed to initialize Razorpay order. Make sure /create-razorpay-order endpoint exists.');
    }
  });

  // Load PayPal SDK dynamically and render server-backed buttons
  (function renderPayPal(){
    if(!CONFIG.PAYPAL_CLIENT_ID || CONFIG.PAYPAL_CLIENT_ID.includes('YOUR')){
      const container = document.getElementById('paypal-container');
      container.innerHTML = '<button class="btn btn-outline-dark" disabled title="Set PAYPAL_CLIENT_ID in CONFIG to enable">PayPal (configure)</button>';
      return;
    }
    const s = document.createElement('script');
    s.src = `https://www.paypal.com/sdk/js?client-id=${encodeURIComponent(CONFIG.PAYPAL_CLIENT_ID)}&currency=${CONFIG.CURRENCY}`;
    s.onload = () => {
      // eslint-disable-next-line no-undef
      paypal.Buttons({
        style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'paypal' },
        createOrder: function(data, actions) {
          // Create order server-side
          const form = collectForm();
          if(!form) return;
          return axios.post('http://localhost:3000/create-paypal-order', {
            amount: form.amount,
            booking: form
          }).then(res => {
            if(res.data && res.data.orderId) return res.data.orderId;
            // Some servers return order as { order: { id } }
            if(res.data && res.data.order && res.data.order.id) return res.data.order.id;
            throw new Error('Invalid PayPal order from server');
          }).catch(err => {
            console.error('PayPal createOrder error', err);
            alert('Failed to create PayPal order. Check server.');
          });
        },
        onApprove: function(data, actions) {
          // data.orderID contains PayPal order id
          return axios.post('http://localhost:3000/capture-paypal-payment', { orderId: data.orderID })
            .then(res => {
              if(res.data && res.data.success) {
                window.location.href = '/success.html';
              } else {
                window.location.href = '/failure.html';
              }
            })
            .catch(err => {
              console.error('PayPal capture error', err);
              window.location.href = '/failure.html';
            });
        },
        onError: function(err){ console.error('PayPal Buttons error', err); alert('PayPal error'); }
      }).render('#paypal-container');
    };
    document.body.appendChild(s);
  })();

  // Stripe flow (redirect to Checkout) - server creates session
  stripeBtn.addEventListener('click', async (ev) => {
    ev.preventDefault();
    const form = collectForm();
    if(!form) return;
    try {
      const resp = await axios.post('http://localhost:3000/create-stripe-session', { booking: form, amount: form.amount, currency: CONFIG.CURRENCY });
      const sessionId = resp.data.id || resp.data.sessionId || resp.data.session?.id;
      if(!sessionId) {
        console.error('Missing session id from server', resp.data);
        alert('Stripe session creation failed.');
        return;
      }
      const stripe = Stripe(CONFIG.STRIPE_PUBLIC_KEY);
      await stripe.redirectToCheckout({ sessionId });
    } catch (err) {
      console.error(err);
      alert('Stripe initialization failed. Make sure /create-stripe-session exists on your server.');
    }
  });

}); // DOMContentLoaded
</script>

</body>
</html>
